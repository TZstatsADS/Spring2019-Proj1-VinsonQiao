coord_flip()
packages.used=c("tm", "wordcloud", "RColorBrewer",
"dplyr", "tydytext")
# check packages that need to be installed.
packages.needed=setdiff(packages.used,
intersect(installed.packages()[,1],
packages.used))
# install additional packages
if(length(packages.needed)>0){
install.packages(packages.needed, dependencies = TRUE,
repos='http://cran.us.r-project.org')
}
library(tm)
library(wordcloud)
library(RColorBrewer)
library(dplyr)
library(tidytext)
folder.path="C:/Users/qws/Desktop"
speeches=list.files(path = folder.path, pattern = "cleaned.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
print(ff.all)
summary(ff.all)
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb"
speeches=list.files(path = folder.path, pattern = "cleaned.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
summary(ff.all)
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-tm_map(ff.all, content_transformer(tolower))
ff.all<-tm_map(ff.all, removeWords, stopwords("english"))
tdm.all<-TermDocumentMatrix(ff.all)
tdm.tidy=tidy(tdm.all)
tdm.overall=summarise(group_by(tdm.tidy, term), sum(count))
ff.all
getwd()
setwd(""C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb")
setwd(C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb")
setwd("C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb")
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb"
speeches=list.files(path = folder.path, pattern = "cleaned.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
summary(ff.all)
setwd("C:/Users/qws/Desktop")
data<-read.csv("cleaned.csv")
folder.path="C:/Users/qwtop"
speeches=list.files(path = folder.path, pattern = "cleaned.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
folder.path="C:/Users/qwtop"
speeches=list.files(path = folder.path, pattern = "cleaned.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb"
speeches=list.files(path = folder.path, pattern = "cleaned.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
ff.all
setwd(â€œC:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb")
setwd("C:/Users/qws/Desktop")
data<-read.csv("cleaned.csv")
setwd("C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb/data/topic_dict")
enterainment<-as.data.frame(read.csv("entertainment-dict.csv",header = FALSE))
exercise<-as.data.frame(read.csv("exercise-dict.csv",header = FALSE))
family<-as.data.frame(read.csv("family-dict.csv",header = FALSE))
food<-as.data.frame(read.csv("food-dict.csv",header = FALSE))
people<-as.data.frame(read.csv("people-dict.csv",header = FALSE))
pets<-as.data.frame(read.csv("pets-dict.csv",header = FALSE))
school<-as.data.frame(read.csv("school-dict.csv",header = FALSE))
shopping<-as.data.frame(read.csv("shopping-dict.csv",header = FALSE))
work<-as.data.frame(read.csv("work-dict.csv",header = FALSE))
numtopic<-as.data.frame(c(nrow(exercise),nrow(family),nrow(food),nrow(people),nrow(pets),nrow(school),nrow(shopping),nrow(work)))
ggplot(numtopic)+
geom_bar(aes(x=c("exercise","family","food","people","pets","school","shopping","work"),y=numtopic[,1]),stat="identity")+
scale_fill_brewer(palette="Set2")+
ggtitle("The number of Happiness things in each topic")+
xlab(NULL)+
ylab(NULL)+
theme(plot.title = element_text(hjust = 0.5))+
coord_flip()
packages.used=c("tm", "wordcloud", "RColorBrewer",
"dplyr", "tydytext")
# check packages that need to be installed.
packages.needed=setdiff(packages.used,
intersect(installed.packages()[,1],
packages.used))
# install additional packages
if(length(packages.needed)>0){
install.packages(packages.needed, dependencies = TRUE,
repos='http://cran.us.r-project.org')
}
library(tm)
library(wordcloud)
library(RColorBrewer)
library(dplyr)
library(tidytext)
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb"
speeches=list.files(path = folder.path, pattern = "cleaned.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-tm_map(ff.all, content_transformer(tolower))
ff.all<-tm_map(ff.all, removeWords, stopwords("english"))
ff.all<-tm_map(ff.all, removeWords, character(0))
ff.all<-tm_map(ff.all, removePunctuation)
tdm.all<-TermDocumentMatrix(ff.all)
tdm.tidy=tidy(tdm.all)
tdm.overall=summarise(group_by(tdm.tidy, term), sum(count))
ff.all
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb/topic_dict"
speeches=list.files(path = folder.path, pattern = "entertainment-dict.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb/2"
speeches=list.files(path = folder.path, pattern = "entertainment-dict.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb"
speeches=list.files(path = folder.path, pattern = "cleaned.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb"
speeches=readLines(filePath)
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb"
speeches=readLines(folder.path)
setwd("C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb/data/topic_dict")
data<-read.csv("cleaned.csv")
setwd("C:/Users/qws/Desktop")
data<-read.csv("cleaned.csv")
data_cat<-data[,9]
Num<-as.data.frame(table(data_cat))
library(ggplot2)
ggplot(Num)+
geom_bar(aes(x=Num[,1],y=Num[,2]),stat="identity",fill=c("lightblue","lightgreen","lightpink","lightgrey","orange","brown","red"))+
ggtitle("The number of Happiness Predicted Topics")+
xlab(NULL)+
ylab(NULL)+
theme(plot.title = element_text(hjust = 0.5))+
coord_flip()
ff.all<-data
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-as.data.frame(data)
ff.all<-tm_map(ff.all, stripWhitespace)
as.data.frame
as.data.frame(data)
ff.all<data
ff.all<-tm_map(ff.all, stripWhitespace)
S<-data[.7]
S
S<-data[.5]
S
S<-data[.4]
S
head(data,3)
data[.5]
S<-data[1.5]
S<-data[,5]
S
segmentCN(S)
ff.all<-tm_map(ff.all, stripWhitespace)
packages.used=c("tm", "wordcloud", "RColorBrewer",
"dplyr", "tydytext")
# check packages that need to be installed.
packages.needed=setdiff(packages.used,
intersect(installed.packages()[,1],
packages.used))
# install additional packages
if(length(packages.needed)>0){
install.packages(packages.needed, dependencies = TRUE,
repos='http://cran.us.r-project.org')
}
library(tm)
library(wordcloud)
library(RColorBrewer)
library(dplyr)
library(tidytext)
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb"
speeches=list.files(path = folder.path, pattern = "cleaned.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
ff.all
ff.all<-tm_map(data, stripWhitespace)
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb"
ff.all<-read.csv("cleaned.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb"
speeches<-read.csv("cleaned.csv")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path))
ff.all
ff.all<-Corpus(data))
ff.all<-Corpus(data)
ff.all<-Corpus(data,VecSource(folder.path))
ff.all<-Corpus(VecSource(data))
ff.all<-Corpus(VectorSource(data))
data<-data[,5]
data()
setwd("C:/Users/qws/Desktop")
data<-read.csv("cleaned.csv")
data_cat<-data[,9]
Num<-as.data.frame(table(data_cat))
library(ggplot2)
ggplot(Num)+
geom_bar(aes(x=Num[,1],y=Num[,2]),stat="identity",fill=c("lightblue","lightgreen","lightpink","lightgrey","orange","brown","red"))+
ggtitle("The number of Happiness Predicted Topics")+
xlab(NULL)+
ylab(NULL)+
theme(plot.title = element_text(hjust = 0.5))+
coord_flip()
data<-data[,5]
ff.all<-Corpus(VectorSource(data))
ff.all
ff.all<-tm_map(data, stripWhitespace)
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-tm_map(ff.all, content_transformer(tolower))
ff.all<-tm_map(ff.all, removeWords, stopwords("english"))
ff.all<-tm_map(ff.all, removeWords, character(0))
ff.all<-tm_map(ff.all, removePunctuation)
tdm.all<-TermDocumentMatrix(ff.all)
tdm.tidy=tidy(tdm.all)
tdm.overall=summarise(group_by(tdm.tidy, term), sum(count))
summary(ff.all)
inspect(ff.all)
print(ff.all)
inspect(tdm.all)
sum(count))
tdm.overall=summarise(group_by(tdm.tidy, term), sum(count))
inspect(tdm.overall)
tdm.overall
table(tdm.all)
tdmm<-as.matrix(tdm.all)
tdmm
dataClean<-data[,5]
dataClean<-unlist(dataClean)
dataClean<-data[,5]
dataClean<-data
dataClean<-as.matrix(unlist(dataClean))
dataClean
length(which(dataClean[,]=="food"))
length(which(dataClean[,]=="on"))
ff.all<-tm_map(ff.all,PlainTextDocument)
ff.all<-DocumentTermMatrix(ff.all)
tdm.all<-TermDocumentMatrix(ff.all)
inspect(ff.all)
packages.used=c("tm", "wordcloud", "RColorBrewer",
"dplyr", "tydytext")
# check packages that need to be installed.
packages.needed=setdiff(packages.used,
intersect(installed.packages()[,1],
packages.used))
# install additional packages
if(length(packages.needed)>0){
install.packages(packages.needed, dependencies = TRUE,
repos='http://cran.us.r-project.org')
}
library(tm)
library(wordcloud)
library(RColorBrewer)
library(dplyr)
library(tidytext)
folder.path="C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb"
speeches=read.csv(folder.path)
setwd("C:/Users/qws/Desktop")
data<-read.csv("cleaned.csv")
dataClean<-data[,5]
ff.all<-Corpus(VectorSource(dataclean))
ff.all<-Corpus(VectorSource(dataClean))
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-tm_map(ff.all, content_transformer(tolower))
ff.all<-tm_map(ff.all, removeWords, stopwords("english"))
ff.all<-tm_map(ff.all, removeWords, character(0))
ff.all<-tm_map(ff.all, removePunctuation)
tdm.all<-TermDocumentMatrix(ff.all)
tdm.tidy=tidy(tdm.all)
tdm.overall=summarise(group_by(tdm.tidy, term), sum(count))
findFreqTerms(ff.all,50)
View(data)
View(ff.all)
packages.used=c("tm", "wordcloud", "RColorBrewer",
"dplyr", "tydytext")
# check packages that need to be installed.
packages.needed=setdiff(packages.used,
intersect(installed.packages()[,1],
packages.used))
# install additional packages
if(length(packages.needed)>0){
install.packages(packages.needed, dependencies = TRUE,
repos='http://cran.us.r-project.org')
}
library(tm)
library(wordcloud)
library(RColorBrewer)
library(dplyr)
library(tidytext)
dataClean<-data[,5]
setwd("C:/Users/qws/Desktop")
data<-read.csv("cleaned.csv")
dataClean<-data[,5]
ff.all<-Corpus(VectorSource(dataClean))
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-tm_map(ff.all, content_transformer(tolower))
ff.all<-tm_map(ff.all, removeWords, stopwords("english"))
ff.all<-tm_map(ff.all, removeWords, character(0))
ff.all<-tm_map(ff.all, removePunctuation)
tdm.all<-DocumentTermMatrix(ff.all)
tdm.tidy=tidy(tdm.all)
tdm.overall=summarise(group_by(tdm.tidy, term), sum(count))
findFreqTerms(ff.all)
inspect
inspect(ff.all)
inspect(tdm.all)
findFreqTerms(tdm.all, 50)
tdm.all1<- removeSparseTerms(tdm.all, sparse=0.6)
data.tdm<- as.data.frame(inspect(tdm.all1))
data.tmd
dtm <- DocumentTermMatrix(ff.all,
control = list(weighting = function(x)
weightTfIdf(x,
normalize =FALSE),
stopwords = TRUE))
ff.dtm=tidy(dtm)
wordcloud(tdm.overall$term, tdm.overall$`sum(count)`,
scale=c(7,0.5),
max.words=500,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Reds"))
wordcloud(tdm.overall$term, tdm.overall$`sum(count)`,
scale=c(7,0.5),
max.words=500,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Reds"))
wordcloud(tdm.overall$term, tdm.overall$`sum(count)`,
scale=c(7,0.1),
max.words=500,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Reds"))
library(wordcloud2)
install.packages("wordcloud2")
library(wordcloud2)
wordcloud2(tdm.overall$term, tdm.overall$`sum(count)`,
scale=c(7,0.1),
max.words=500,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
color = "skyblue",figPath = figPath)
wordcloud2(tdm.overall$`sum(count)`, figPath = figPath, size = 1.5,color = "skyblue")
wordcloud2(tdm.overall$term,tdm.overall$`sum(count)`, figPath = figPath, size = 1.5,color = "skyblue")
wordcloud2(tdm.overall,tdm.overall$`sum(count)`, figPath = figPath, size = 1.5,color = "skyblue")
wordcloud(tdm.overall$term, tdm.overall$`sum(count)`,
scale=c(7,0.1),
max.words=500,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Reds"))
wordcloud(tdm.overall$term, tdm.overall$`sum(count)`,
scale=c(7,0.1),
max.words=500,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(9,"Blues"))
wordcloud(tdm.overall$term, tdm.overall$`sum(count)`,
scale=c(7,0.1),
max.words=500,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(8,"Dark2"))
setwd("C:/Users/qws/Desktop")
data<-read.csv("cleaned.csv")
data_cat<-data[,9]
Num<-as.data.frame(table(data_cat))
library(ggplot2)
ggplot(Num)+
geom_bar(aes(x=Num[,1],y=Num[,2]),stat="identity",fill=c("lightblue","lightgreen","lightpink","lightgrey","orange","brown","red"))+
ggtitle("The number of Happiness Predicted Topics")+
xlab(NULL)+
ylab(NULL)+
theme(plot.title = element_text(hjust = 0.5))+
coord_flip()
data_cat<-data[,9]
Num<-as.data.frame(table(data_cat))
library(ggplot2)
ggplot(Num)+
geom_bar(aes(x=Num[,1],y=Num[,2]),stat="identity",fill=c("lightblue","lightgreen","lightpink","lightgrey","orange","brown","yellow"))+
ggtitle("The number of Happiness Predicted Topics")+
xlab(NULL)+
ylab(NULL)+
theme(plot.title = element_text(hjust = 0.5))+
coord_flip()
setwd("C:/Users/qws/Desktop/CU 2018 Fall/STAT 5243/WhatMakeUhappy/data/1/happydb/data")
senselabel<-read.csv("senselabel.csv",header=FALSE)
hist(senselabel[,5])
factor(senselabel[,5])
levels(senselabel[,5])
as.vector(levels(senselabel[,5]))
length(senselabel[which==as.vector(levels(senselabel[,5]),5)])
setwd("C:/Users/qws/Desktop")
data<-read.csv("cleaned.csv")
price<-1000*exp(-10*(0.04+0.001*10))
price
CouponPayments<-1000*0.085*0.5
CouponPayments
pnorm(log(97/100),0.0002*20,0.03*sqrt(20))
1-pnorm(log(97/100),0.0002*20,0.03*sqrt(20))
1-pnorm(log(100/97),0.0002*20,0.03*sqrt(20))
find<-function(t){
return(pnorm(log(2),0.005*t,0.012*sqrt(t)))
}
for (i in 1:10000) {
if(find(i)<0.1)(break)
}
i
find<-function(t){
return(pnorm(log(2),0.005*t,0.012*sqrt(t),lower.tail =TRUE ))
}
for (i in 1:10000) {
if(find(i)<0.1)(break)
}
i
find<-function(t){
return(pnorm(log(2),0.005*t,0.012*sqrt(t),lower.tail =FALSE ))
}
for (i in 1:10000) {
if(find(i)>=0.9)(break)
}
i
i
find<-function(t){
return(pnorm(log(2),0.005*t,0.012*sqrt(t),lower.tail =FALSE ))
}
for (i in 1:10000) {
if(find(i)>=0.1)(break)
}
i
find<-function(t){
return(pnorm(log(2),0.005*t,0.012*sqrt(t),lower.tail =FALSE ))
}
for (i in 1:10000) {
if(find(i)>=0.9)(break)
}
i
wordcloud(tdm.overall$term, tdm.overall$`sum(count)`,
scale=c(7,0.1),
max.words=500,
min.freq=1,
random.order=FALSE,
rot.per=0.3,
use.r.layout=T,
random.color=FALSE,
colors=brewer.pal(8,"Dark2"))
data_cat<-data[,9]
Num<-as.data.frame(table(data_cat))
library(ggplot2)
ggplot(Num)+
geom_bar(aes(x=Num[,1],y=Num[,2],fill=c("lightblue","lightgreen","lightpink","lightgrey","orange","brown","yellow")),stat="identity")+
ggtitle("The number of Happiness Predicted Topics")+
xlab(NULL)+
ylab(NULL)+
theme(plot.title = element_text(hjust = 0.5))+
coord_flip()
ggplot(Num)+
geom_bar(aes(x=Num[,1],y=Num[,2],fill=c("lightblue","lightgreen","lightpink","lightgrey","orange","brown","yellow")),stat="identity")+
ggtitle("The number of Happiness Predicted Topics")+
xlab(NULL)+
ylab(NULL)+
theme(plot.title = element_text(hjust = 0.5))+
coord_flip()
data_cat<-data[,9]
Num<-as.data.frame(table(data_cat))
library(ggplot2)
ggplot(Num)+
geom_bar(aes(x=Num[,1],y=Num[,2],fill=c("lightblue","lightgreen","lightpink","lightgrey","orange","brown","yellow")),stat="identity")+
ggtitle("The number of Happiness Predicted Topics")+
xlab(NULL)+
ylab(NULL)+
theme(plot.title = element_text(hjust = 0.5),legend.text=NULL)+
coord_flip()
data_cat<-data[,9]
Num<-as.data.frame(table(data_cat))
library(ggplot2)
ggplot(Num)+
geom_bar(aes(x=Num[,1],y=Num[,2],fill=c("lightblue","lightgreen","lightpink","lightgrey","orange","brown","yellow")),stat="identity")+
ggtitle("The number of Happiness Predicted Topics")+
xlab(NULL)+
ylab(NULL)+
theme(plot.title = element_text(hjust = 0.5),legend.tittle=NULL)+
coord_flip()
